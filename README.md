# Проектная работа "Веб-ларек"

Реализация интернет-магазина "Web Ларёк".

- Используемый стек: HTML, SCSS, TS.
- Для сборки используется Webpack.
- Подключен линтер ESLint.

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура

## Базовый код

В проекте используется архитектурный стиль MVP(Model-View-Presenter). Данная архитектура разделяет слои ответсвенности между классами данных (Model) и отображений (View), координация между которыми происходит посредством контроллера-презентера (Presenter).

Слой данных (Model) - отвечает за загрузку данных по API и данными пользовательского ввода. Так-же в моделях хранится сама бизнес логика приложения.

Слой отображения (View) - отвечает за отображение пользовательского интерфейса.

EventEmitter (Presenter) - связывает интерфейсы и модели данных при срабатывании событий.

## Описание базовых классов

### 1. Класс Api
Описывает реализацию взаимодействия приложения с сервером по HTTP протоколу.
Имеет атрибут конфигурации, в котором хранится путь к серверу, базовые заголовки запроса.
Имеет атрибуты:
```ts
baseUrl: string // базовый путь к серверу
options: RequestInit // настройки HTTP запроса
```
Имеет методы:
```ts
handleResponse: (response: Response) => Promise<object> // логика обработки ответа сервера
get: (uri: string) => Promise<object> // отправка гет-запроса
post: (uri: string, data: object, method: ApiPostMethods = 'POST') => Promise<object> // отправка пост-запроса
```


### 2. Класс EventEmitter (Presenter)
Координирует взаимодействие слоев данных и отображения, использует брокер событий.
Имеет атрибуты:
```ts
events: Map<EventName, Set<Subscriber>> // Список зарегестрированных событий
```
Имеет методы:
```ts
on<T extends object>(eventName: EventName, callback: (event: T) => void) // регистрация обработчика события
emit<T extends object>(eventName: string, data?: T) // отправка события с данными
trigger<T extends object>(eventName: string, context?: Partial<T>) // создает коллбэк, отправляющий событие при вызове
off(eventName: EventName, callback: Subscriber) // снятие регистрации обработчика события
onAll(callback: (event: EmitterEvent) => void) // начать слушать зарегестрированные события
offAll: () // сбросить регистрацию всех событий
```


## Описания классов слоя данных (Model)

### 1. Класс CartModel

Используется для заполнения данных клиента и работы с корзиной товаров. Работает с данными, полученными от пользователя.

Имеет следующие атрибуты:

```ts
products: IProduct[]  // список выбранных продуктов в корзине
paymentMethod: string // метод оплаты
address: string       // адрес доставки
phoneNumber: string   // номер телефона клиента
email:string          // электронная почта клиента

```

Класс имеет следующие методы:

```ts
addProduct: (product: IProduct) => void    // добавление продукта в корзину
deleteProduct: (product: IProduct) => void // удаление продукта из корзины
getItemsCount: () => number                // возвращает количество заказов в корзине
getItemsTotal: () => number                // итоговая сумма покупки
resetItems() => void // очистка корзины
```

### 2. Класс ApiProductsModel

Этот класс наследуется от класса [Api](### 1. Класс Api) и отвечает за взаимодействие со товарами на сервере
Имеет методы:
```ts
getProductList(): Promise<IProduct[]> // получить список товаров с сервера
getProduct(id: string): Promise<IProduct> // получить информацию по конкретному товару
```

### 3. Класс ApiOrderModel

Этот класс наследуется от класса [Api](### 1. Класс Api) и отвечает за оформление заказа на сервере
```ts
postOrder(data: ICart): Promise<object> // отправить данные по заказу на 
_mapModelToBodyObject(data: ICart): object // формирует тело запроса на основании модели корзины
```

### 4. Класс AppState

Этот класс отвечает за хранение состояния приложения. Имеет следующие методы:
```ts
products(products: IProduct[]) // установка первоначального списка товаров
setPreview(product: IProduct) // открытие модального окна и сохранение выбранного товара
```

## Классы отображения (View)

### 1. Класс BaseView (абстрактный)

Базовый класс отображения, от которого будут наследоваться остальные классы.
Класс имеет следующие методы:
```ts
 render(data: unknown): HTMLElement // рендер, вызывается когда надо обновить отображение с данными

```

### 2. Класс ProductView

Используется для отображения информации о товаре, наследуется от BaseView.
Класс имеет следующие атрибуты:
```ts
category?: HTMLElement; //элемент отображения категории
title: HTMLElement; // элемент отображения названия
image?: HTMLImageElement; // отображение картинки
description?: HTMLElement; // отображение описания
price: HTMLElement; // цена
button?: HTMLButtonElement; // кнопка
categoryColor = <Record<string, string>> // сопоставление категории товара по цвету
```
Класс имеет следующие методы:
```ts
title(title: string) // установка названия товара для отображения
image(path: string) // установка картинки товара для отображения
price(price: string) // установка цены товара для отображения
category(category: string) // установка категории товара для отображения
description(description: string) // установка описания товара для отображения
button(buttonText: string) // установка текста кнопки
```

### 3. Класс CartView

Используется для отображения наполнения корзины, наследуется от BaseView.
Класс имеет следующие атрибуты:
```ts
list: HTMLElement; // элемент для отображения списка товаров в корзине
button: HTMLButtonElement; // кнопка "оформить"
total: HTMLElement; // элемент для отображения стоимости корзины
```
Класс имеет следующие методы:
```ts
list(items: HTMLElement[]) // установка элементов списка товаров в корзине
total(total: number) // установка суммы всех товаров в корзине
```

### 4. Класс AddressView

Используется для отображения формы ввода адреса и способа оплаты, наследуется от BaseView.
Класс имеет следующие атрибуты:
```ts
paymentMethodCard: HTMLElement; // элемент выбора метода оплаты картой
paymentMethodCash: HTMLElement; // элемент выбора метода оплаты наличными
address: HTMLInputElement; // инпут ввода адреса
button: HTMLButtonElement; //  кнопка "далее"
selectedPaymentMethod: string; // строковое значение выбранного способа оплаты
adressState: AdressState; // состояние формы
events: IEvents; // брокер событий
```
Класс имеет следующие методы:
```ts
address(address: string) // установка значения и состояния ввода адреса
validate() // валидация формы для активации кнопки
reset() // сброс данных формы
```
### 5. Класс ContactsView

Используется для отображения формы ввода электронной почты и номера телефона, наследуется от BaseView.
Класс имеет следующие атрибуты:
```ts
emailInput: HTMLInputElement; // инпут ввода емейла
phoneInput: HTMLInputElement; // инпут ввода номера телефона
state: IContactsState; // состояние формы
button: HTMLButtonElement; // кнопка "далее"
```
Класс имеет следующие методы:
```ts
validate() // валидация формы для активации кнопки
reset() // сброс данных формы
```


### 6. Класс SuccessView

Используется для отрисовки информации об успешном заказе, наследуется от BaseView.

Класс имеет следующие атрибуты:
```ts
total: HTMLElement; // элемент отображения суммы оформленного заказа
button: HTMLButtonElement; // кнопка "за следующими покупками"
```

Класс имеет следующие методы:
```ts
total(total: number) // установка суммы заказа
```

### 7. Класс PageView

Используется для работы со страницей сайта, наследуется от BaseView.
Класс имеет следующие атрибуты:
```ts
counter: HTMLElement; // элемент для отображения количества товаров в корзине
catalog: HTMLElement; // список товаров
cart: HTMLElement; // элемент для отображения иконки корзины
```
Класс имеет следующие методы:
```ts
counter(counter: number) // количество товаров в корзине
catalog(items: HTMLElement[]) // список товаров
```

### 8. Класс Modal

Используется для отображения модальных окон, наследуется от BaseView.

Класс имеет следующие атрибуты:
```ts
closeButton: HTMLButtonElement; // кнопка закрытия модального окна
content: HTMLElement; // контент для отображения внутри модального окна
```
Класс имеет следующие методы:
```ts
content(value: HTMLElement) // установка контента для отображения
open() // открыть окно
close() // закрыть окно
render(): HTMLElement // отрисовка окна с контентом
```
